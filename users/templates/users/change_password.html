{% extends 'mainblog/base.html' %}

{% block menu %}
    <div class="outer_menu_container">
        <div class="inner_menu_container">
            {% if not user.is_authenticated %}
                <div class="menu">
                    <span><a class="menu_button" href="{% url 'home' %}">Главная</a></span>
                    <span><a class="menu_button" href="{% url 'all_products' %}">Индекс борща</a></span>
                    <span><a class="menu_button" href="{% url 'registration' %}">Регистрация</a></span>
                    <span><a class="menu_button" href="{% url 'user' %}">Вход</a></span>
                </div>
            {% else %}
                {% if user.username == 'admin' or user.username == 'prothean' %}
                    <div class="menu">
                        <span><a class="menu_button" href="{% url 'home' %}">Главная</a></span>
                        <span><a class="menu_button" href="{% url 'all_products' %}">Индекс борща</a></span>
                        <span><a id="profile_link" class="menu_button" href="{% url 'profile' %}">Профиль</a></span>
                        <span><a class="menu_button" href="{% url 'article_add' %}">Написать статью</a></span>
                        <span><a class="menu_button" href="{% url 'user_articles' user.username %}">Мои статьи</a></span>
                        <span><a class="menu_button" href="{% url 'exit' %}">Выход</a>{# (<b>{{ user.username }}</b>) #}</span>
                    </div>
                {% else %}
                    <div class="menu">
                        <span><a class="menu_button" href="{% url 'home' %}">Главная</a></span>
                        <span><a class="menu_button" href="{% url 'all_products' %}">Индекс борща</a></span>
                        <span><a class="menu_button" href="{% url 'profile' %}">Профиль</a></span>
                        <span><a class="menu_button" href="{% url 'exit' %}">Выход</a> (<b>{{ user.username }}</b>)</span>
                    </div>
                {% endif %}
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block title %}
    Кабинет пользователя
{% endblock %}

{% block content %}
    <div class="user_profile">
        <h3>Смена пароля</h3>
        <div class="change_password_block">
            <form class="change_password_form" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <span>Введите старый пароль:</span>
                {{ form.old_password|safe }}
                <span>Введите новый пароль:</span>
                {{ form.new_password1|safe }}
                <div class="helptext">
                    <span>Пароль должен состоять не менее чем из 8 знаков, содержать цифры и символы в верхнем и нижнем регистрах. Придумайте пароль самостоятельно или воспользуйтесь паролем, сгенерированным автоматически.</span>
                </div>
                <div class="helptext">
                    Случайный пароль: <b class="hide_password">{{ password }}</b>
                </div>
                <br>
                <span>Введите новый пароль ещё раз:</span>
                {{ form.new_password2|safe }}
                <div class="helptext">
                    <span>Пароли в этом и предыдущем полях должны полностью совпадать</span>
                </div>
                <button type="submit">Обновить</button>
            </form>
        </div>
    </div>

{% endblock %}